@model FAPP.Areas.AM.ViewModels.ItemRegisterVM
@using FAPP.DAL;
@section topRightMenu
{
    <ul class="minitiles">
        @*<li class="orange">
                <a href="/Setup/Branches/ManageBuildings/@(SessionHelper.BranchId)" target="_blank" title="Add New Location">
                    <i class="fa fa-plus" aria-hidden="true"></i>
                </a>
            </li>*@
        <li class="dropdown setup orange " style="margin-right:0">
            <a href="#" class="dropdown-toggle" title="" data-toggle="dropdown" aria-expanded="false" data-original-title="Issuance Reports">
                <i class="fa fa-file"></i>
                <span class="caret"></span>
            </a>
            <ul class="dropdown-menu pull-right setup">
                <li>
                    <a href="/AM/Reports/Issuance" target="_blank" title="Go to Issuance" data-original-title="Print">
                        Issuance
                    </a>
                </li>
                <li>
                    <a href="/AM/Reports/Damages" target="_blank" title="" data-original-title="Print">
                        Damages
                    </a>
                </li>
                <li>
                    <a href="/AM/Reports/Summary" target="_blank" title="" data-original-title="Print">
                        Summary
                    </a>
                </li>
                <li>
                    <a href="/AM/Reports/AssetLog" target="_blank" title="" data-original-title="Print">
                        Asset Log
                    </a>
                </li>
            </ul>
        </li>
        <li class="blue">
            <a href="#new-itemRegister" data-toggle="modal" title="Create Item Register">
                <i class="fa fa-plus"></i>
            </a>
        </li>
    </ul>
    <ul hidden class="stats">
        <li class="satgreen" title="Total Items">
            <i class="fa fa-slack"></i>
            <div class="details">
                @*<span class="big largeFont" id="topTotal">
                    </span>*@
            </div>
        </li>
    </ul>
}
<script>
    function showOrHide() {
        $('#returnbtn').hide();
        $('#issuebtn').hide();
        if ($('[data-name="checkbox"]:checked').length > 0) {
            if ($('#status').val()) {
                if ($('#status').val() == "Issued") {
                    $('#returnbtn').show();
                } else if ($('#status').val() == "InStock") {
                    $('#issuebtn').show();
                }
            } else {
                $('#status').select2('open');
            }
        }
    }

    $(document).on('change', '#status', function () {
        showOrHide();
    })

    $(document).on('change', '[id $="IsCheked"]', function () {
        $('#headcheckbox_zee').prop("checked", false);
        showOrHide();
    })

    $(document).on('change', '[data-action="checkUncheck_zee"]', function () {
        if ($('[data-action="checkUncheck_zee"]').prop('checked') === true)
            $('[data-name="checkbox"]').prop("checked", true);
        else
            $('[data-name="checkbox"]').prop("checked", false);
        showOrHide();
    });
</script>
@using (Ajax.BeginForm("ItemPosition", "Issue", new AjaxOptions { HttpMethod = "POST", UpdateTargetId = "divStudents", LoadingElementId = "loader" }))
{
    @Html.AntiForgeryToken()
    <div class="vbox col-md-12 form-inline ">
        <table class="col-md-12">
            <tr>
                <td width="120px"> @Html.TextBoxFor(model => model.FromDate, new { @class = "datepicker form-control", @placeholder = "From Date", @style = "width:100%" })</td>
                <td width="120px"> @Html.TextBoxFor(model => model.ToDate, new { @class = "datepicker form-control", @placeholder = "From Date", @style = "width:100%" })</td>
                <td> @Html.DropDownListFor(model => model.status, new SelectList(ViewBag.Statuses, "Value", "Text", Model.status), "--All Status--", htmlAttributes: new { @class = "form-control", @style = "width:200px" })</td>
                <td>  @Html.DropDownListFor(model => model.CategoryId, new SelectList(ViewBag.Categories, "Value", "Text", Model.CategoryId), "--All Categories--", htmlAttributes: new { @class = "form-control", @style = "width:200px" })</td>
                <td width="200px">@Html.TextBoxFor(model => model.ItemCode, new { @class = " form-control", @placeholder = "Search Item Code,Item Name", @title = "Search By Item Name and Code", @style = "width:100%" })</td>
                @*<td>@Html.DropDownListFor(model => model.ItemId, new SelectList(ViewBag.ItemsDD, "Value", "Text", Model.ItemId), "--Select Item--", htmlAttributes: new { @class = "form-control", @style = "width:100%;" })</td>*@
                <td><input type="submit" class="btn btn-primary" value="Search" title="Search" /></td>
            </tr>
            <tr>
                @*<td>@Html.DropDownListFor(m => m.ItemCodeDetailId, new SelectList(ViewBag.ItemCodes, "Value", "Text", Model.ItemCodeDetailId), "--Select Item Code--", new { @class = "form-control ", @style = "width:100%;" })</td>*@

                <td colspan="2"> @Html.DropDownListFor(model => model.ConditionTypeId, new SelectList(ViewBag.ConditionTypesDD, "Value", "Text", Model.ConditionTypeId), "--All Condition--", htmlAttributes: new { @class = "form-control", @style = "width:250px" })</td>
                <td width="150px">  @Html.DropDownListFor(model => model.DepartmentId, new SelectList(ViewBag.DepartmentsDD, "Value", "Text", Model.DepartmentId), "--All Department--", htmlAttributes: new { @class = "form-control", @style = "width:200px" })</td>
                <td width="150px"> @Html.DropDownListFor(model => model.EmployeeId, new SelectList(ViewBag.EmployeesDD, "Value", "Text", Model.EmployeeId), "--All Employee--", htmlAttributes: new { @class = "form-control", @style = "width:200px;" })</td>
                <td width="200px">   @Html.DropDownListFor(model => model.RoomId, new SelectList(ViewBag.RoomsDD, "Value", "Text", Model.RoomId), "--All Location--", htmlAttributes: new { @class = "form-control", @style = "width:200px" })</td>
                @*<td>   @Html.DropDownListFor(model => model.Type, new SelectList(ViewBag.Types, "Value", "Text", Model.Type), "--Select Type--", htmlAttributes: new { @class = "form-control", @style = "width:100%" })</td>*@
            </tr>
        </table>
    </div>

    @*<div id="footeractions">
            <span>with checked</span>
            <button type="submit" class="small blue Unpost" name="command" value="Retrun" title="Retrun Item(s)">Retrun Item(s)</button>
        </div>*@

    <div id="divStudents">
        @Html.Partial("_PartialItemPosition", Model)
    </div>

}
<div id="new-itemRegister" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header" style="background-color: #368ee0 !important;color:white;">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title" id="myModalLabel">Add Item Register</h4>
            </div>
            @using (Ajax.BeginForm("CreateItemRegister", "Issue",
                new AjaxOptions { HttpMethod = "POST", OnBegin = "OnBegin", OnComplete = "OnComplete('new-itemRegister')", OnSuccess = "OnCreateUpdateSuccess", OnFailure = "OnFailure" },
                new { @class = "new-task-form form-horizontal form-bordered" }))
            {
                Html.EnableClientValidation(true);
                <div class="modal-body nopadding">
                    <div class="form-group">
                        <label for="tasktitel" class="col-sm-2 control-label">Product </label>
                        <div class="col-sm-4">
                            @Html.DropDownListFor(m => m.ItemRegisterItem.ProductId, new SelectList(ViewBag.Products, "Value", "Text", Model.ItemRegisterItem.ProductId), "--- Select Product ----", new { @class = "form-control chosen-select", @style = "width:100%;" })
                            @Html.ValidationMessageFor(model => model.ItemRegisterItem.ProductId, null, new { @class = "text-danger" })
                        </div>
                        <label for="tasktitel" class="col-sm-2 control-label">Code</label>
                        <div class="col-sm-4">
                            @Html.TextBoxFor(model => model.ItemRegisterItem.ItemManualCode, new { @required = true, @class = "form-control ", @placeholder = "Item Code" })
                            @Html.ValidationMessageFor(model => model.ItemRegisterItem.ItemManualCode, null, new { @class = "text-danger" })
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="tasktitel" class="col-sm-2 control-label">Condition</label>
                        <div class="col-sm-4">
                            @Html.DropDownListFor(m => m.ItemRegisterItem.ConditionTypeId, new SelectList(ViewBag.ConditionTypes, "Value", "Text", Model.ItemRegisterItem.ConditionTypeId), "---- Select Condition ----", new { @class = "form-control chosen-select", @style = "width:100%;" })
                        </div>
                        <label for="tasktitel" class="col-sm-2 control-label">Value</label>
                        <div class="col-sm-4">
                            @Html.TextBoxFor(model => model.ItemRegisterItem.Value, new { @required = true, @class = "form-control ", @placeholder = "Value" })
                            @Html.ValidationMessageFor(model => model.ItemRegisterItem.Value, null, new { @class = "text-danger" })
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="tasktitel" class="col-sm-2 control-label">Date</label>
                        <div class="col-sm-4">
                            @Html.TextBoxFor(model => model.ItemRegisterItem.DateOfEntry, new { @class = "datepicker form-control", @placeholder = "Entry Date", @style = "width:100%" })
                            @Html.ValidationMessageFor(model => model.ItemRegisterItem.DateOfEntry, null, new { @class = "text-danger" })
                        </div>
                        <label for="tasktitel" class="col-sm-2 control-label">Status</label>
                        <div class="col-sm-4">
                            @Html.EnumDropDownListFor(x => x.ItemRegisterItem.Status, "-- Select status --", new { @class = "form-control", @style = "width:100%;" })
                            @*@Html.EditorFor(m => m.ItemRegisterItem.sta, new SelectList(ViewBag.Employees, "Value", "Text", Model.ItemRegisterItem.EmployeeId), "---- Select Employee ----", new { @class = "form-control chosen-select", @style = "width:300px;" })*@
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="tasktitel" class="col-sm-2 control-label">Status</label>
                        <div class="col-sm-4">
                            @Html.EnumDropDownListFor(x => x.ItemRegisterItem.Status, "-- Select status --", new { @class = "form-control", @style = "width:100%;" })
                            @*@Html.EditorFor(m => m.ItemRegisterItem.sta, new SelectList(ViewBag.Employees, "Value", "Text", Model.ItemRegisterItem.EmployeeId), "---- Select Employee ----", new { @class = "form-control chosen-select", @style = "width:300px;" })*@
                        </div>
                        <label for="tasktitel" class="col-sm-2 control-label">Description</label>
                        <div class="col-sm-4">
                            @Html.TextBoxFor(model => model.ItemRegisterItem.Description, new { @class = "form-control", @placeholder = "Description", @style = "width:100%" })
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="tasktitel" class="col-sm-2 control-label">Current Value</label>
                        <div class="col-sm-4">
                            @Html.TextBoxFor(model => model.ItemRegisterItem.CurrentValue, new { @required = true, @class = "form-control ", @placeholder = "Current Value" })
                        </div>
                        <label for="tasktitel" class="col-sm-2 control-label">Salvage Value</label>
                        <div class="col-sm-4">
                            @Html.TextBoxFor(model => model.ItemRegisterItem.SalvageValue, new { @required = true, @class = "form-control ", @placeholder = "Salvage Value" })
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="tasktitel" class="col-sm-2 control-label">Depreciation Date</label>
                        <div class="col-sm-4">
                            @Html.TextBoxFor(model => model.ItemRegisterItem.LastDepreciationDate, new { @class = "datepicker form-control", @placeholder = "Last Depreciation Date", @style = "width:100%" })
                        </div>
                        <label for="tasktitel" class="col-sm-2 control-label">Due Depreciation Date</label>
                        <div class="col-sm-4">
                            @Html.TextBoxFor(model => model.ItemRegisterItem.NextDueDepreciationDate, new { @class = "datepicker form-control", @placeholder = "Next Due Depreciation Date", @style = "width:100%" })
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="tasktitel" class="col-sm-2 control-label">Depreciation Percentage</label>
                        <div class="col-sm-4">
                            @Html.TextBoxFor(model => model.ItemRegisterItem.DepreciationPercentage, new { @required = true, @class = "form-control ", @placeholder = "Depreciation Percentage" })
                        </div>
                    </div>
                    @*<div class="form-group">
                            <label for="tasktitel" class="col-sm-3 control-label">Location</label>
                            <div class="col-sm-9">
                                @Html.DropDownListFor(m => m.ItemRegisterItem.CurrentLocationId, new SelectList(ViewBag.Locations, "Value", "Text", Model.ItemRegisterItem.CurrentLocationId), "---- Select Location ----", new { @class = "form-control chosen-select", @style = "width:300px;" })
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="tasktitel" class="col-sm-3 control-label">Department</label>
                            <div class="col-sm-9">
                                @Html.DropDownListFor(m => m.ItemRegisterItem.CurrentdepartmentId, new SelectList(ViewBag.Departments, "Value", "Text", Model.ItemRegisterItem.CurrentdepartmentId), "---- Select Department ----", new { @class = "form-control chosen-select", @style = "width:300px;" })

                            </div>
                        </div>
                        <div class="form-group">
                            <label for="tasktitel" class="col-sm-3 control-label">Employee</label>
                            <div class="col-sm-9">
                                @Html.DropDownListFor(m => m.ItemRegisterItem.EmployeeId, new SelectList(ViewBag.Employees, "Value", "Text", Model.ItemRegisterItem.EmployeeId), "---- Select Employee ----", new { @class = "form-control chosen-select", @style = "width:300px;" })
                            </div>
                        </div>*@

                </div>
                <div class="modal-footer">
                    <input type="button" class="btn btn-orange" data-dismiss="modal" value="Cancel">
                    <input type="submit" class="btn btn-primary" value="Save Item Register">
                </div>
            }
        </div>
    </div>
</div>

<script>

    showOrHide();

    $('#extendedPageHeader').html(`<p style="margin:11px 0px 0px 0px">
@{
<label class="label label-darkblue" title="Total Items">Total: @(Model?.CurrentItemRegister?.TotalItemCount??0)</label>
} </p>`);
</script>